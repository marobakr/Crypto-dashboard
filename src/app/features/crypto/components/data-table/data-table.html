<div
  class="relative overflow-x-auto md:overflow-x-hidden overflow-y-hidden"
  aria-label="Cryptocurrency data table"
>
  <table class="w-full text-sm text-left rtl:text-right text-black" role="table">
    <thead class="text-xs capitalize bg-white border-t border-b border-primary">
      <tr>
        <th scope="col" class="px-6 py-3">name</th>
        <th scope="col" class="px-6 py-3">price</th>
        <th scope="col" class="px-6 py-3">change</th>
        <th scope="col" class="px-6 py-3">chart</th>
        <th scope="col" class="px-6 py-3 flex items-center gap-2">
          <span> live </span>
          <span class="text-xs w-2 h-2 rounded-full bg-green-500"></span>
        </th>
        <th scope="col" class="px-6 py-3">action</th>
      </tr>
    </thead>
    <tbody>
      @for (crypto of cryptoData | search : searchValue; track crypto.id) {
      <tr class="border-b border-primary hover:bg-gray-100">
        <td class="px-6 py-4 flex flex-col md:flex-row items-start md:items-center gap-2">
          <img [src]="crypto.image" [alt]="crypto.name" class="w-7 md:w-10" loading="lazy" />
          <span
            [title]="crypto.name"
            class="text-sm font-medium text-center md:text-left line-clamp-1"
            >{{ crypto.name }}</span
          >
        </td>
        <td
          [class]="crypto.price_change_percentage_24h >= 0 ? 'text-green-500' : 'text-red-500'"
          class="px-6 py-4 font-semibold"
        >
          {{ crypto.current_price | currency }}
        </td>
        <td
          [class]="crypto.price_change_percentage_24h >= 0 ? 'text-green-500' : 'text-red-500'"
          class="px-6 py-4 font-semibold"
        >
          {{ crypto.price_change_percentage_24h | percent }}
        </td>
        <td class="px-6 max-w-[150px]">
          <app-chart
            [color]="getPriceChangePercentageColor(crypto.price_change_percentage_24h)"
            [series]="[{ data: crypto.sparkline_in_7d.price, name: crypto.name }]"
          />
        </td>
        <td class="px-6 max-w-[50px]">
          <app-chart
            [color]="getPriceChangePercentageColor(crypto.price_change_percentage_24h)"
            [series]="[{ data: livePricesMap[crypto.id] || [], name: crypto.name }]"
          />
        </td>
        <td class="px-6 py-4">
          <button
            (click)="removeCrypto(crypto.id)"
            class="text-primary cursor-pointer transition-colors"
            aria-label="Remove cryptocurrency"
          >
            <svg
              class="w-5 h-5"
              fill="none"
              stroke="currentColor"
              viewBox="0 0 24 24"
              xmlns="http://www.w3.org/2000/svg"
            >
              <path
                stroke-linecap="round"
                stroke-linejoin="round"
                stroke-width="2"
                d="M6 18L18 6M6 6l12 12"
              ></path>
            </svg>
          </button>
        </td>
      </tr>
      } @empty {
      <tr>
        <td colspan="6" class="text-center py-4 capitalize">No data found</td>
      </tr>
      }
    </tbody>
  </table>
</div>
